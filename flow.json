[{"id":"2e299254.21ad6e","type":"tab","label":"Flow 2","disabled":false,"info":""},{"id":"2135ef5d.634de","type":"sqlitedb","z":"","db":"/tmp/sqlite","mode":"RWC"},{"id":"a2a22835.7fe9e8","type":"sqlitedb","z":"","db":"/home/pi/Documents/blockchainlist","mode":"RWC"},{"id":"d9a7944f.e4c788","type":"rpi-sensehat in","z":"2e299254.21ad6e","name":"Temperature","motion":false,"env":true,"stick":false,"x":120,"y":180,"wires":[["b40a505c.5337d"]]},{"id":"1a17e554.dac36b","type":"function","z":"2e299254.21ad6e","name":"temperature","func":"var datenow = Date.now();\nvar tempInput = msg.payload;\ndatenow = datenow.toString();\ntemperaturenow = tempInput.temperature.toString();\nvar mac\n\nvar newMsg = {\n    \"payload\" :{\n        \"date\": datenow,\n        \"temperature\": temperaturenow,\n        \"MAC\": mac\n    },\n    //\"topic\": \"INSERT INTO blockchainlist(currentdate, temperature) values ( \" + datenow + \", \" + tempInput.temperature + \")\"\n      \"topic\": 'INSERT INTO blockchainlist(currentdate, temperature, MAC) values ('+datenow+','+tempInput.temperature+',\"b8:27:eb:c2:a8:3c\")'\n\n        };\nreturn newMsg;","outputs":1,"noerr":0,"x":475.00001525878906,"y":164.64287090301514,"wires":[["57c369e7.b644b8"]]},{"id":"6ccd9850.3feef8","type":"debug","z":"2e299254.21ad6e","name":"DATABASE OUT","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":884.2856826782227,"y":201.42857456207275,"wires":[]},{"id":"9c4db387.f7e86","type":"inject","z":"2e299254.21ad6e","name":"CREATE","topic":"CREATE TABLE blockchainlist(id INTEGER PRIMARY KEY AUTOINCREMENT, currentdate DATE, temperature TEXT, MAC TEXT)","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":260,"wires":[["57c369e7.b644b8"]]},{"id":"57c369e7.b644b8","type":"sqlite","z":"2e299254.21ad6e","mydb":"a2a22835.7fe9e8","sqlquery":"msg.topic","sql":"","name":"","x":697.1428375244141,"y":265.71429347991943,"wires":[["6ccd9850.3feef8"]]},{"id":"ac8a069.15c5bf8","type":"rpi-sensehat out","z":"2e299254.21ad6e","name":"","x":587.5714530944824,"y":481.4285774230957,"wires":[]},{"id":"b40a505c.5337d","type":"delay","z":"2e299254.21ad6e","name":"Delay","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"10","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":266.892822265625,"y":122.71427536010742,"wires":[["1a17e554.dac36b","1bd60a4a.f4a596"]]},{"id":"d963537b.d43d","type":"function","z":"2e299254.21ad6e","name":"hatout","func":"var newMsg = {\n    \"payload\" :\n        '0,0,green'\n   };\nflow.set(\"X\", 0, \"Y\", 0);\nreturn newMsg;","outputs":1,"noerr":0,"x":289.0000286102295,"y":480.35711765289307,"wires":[["ac8a069.15c5bf8"]]},{"id":"9af24af0.e592f8","type":"inject","z":"2e299254.21ad6e","name":"","topic":"","payload":"hatout","payloadType":"flow","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":107.5000228881836,"y":481.60711669921875,"wires":[["d963537b.d43d"]]},{"id":"24d0ab84.ab4f74","type":"function","z":"2e299254.21ad6e","name":"stick","func":"\nvar X = flow.get(\"X\")||0;\n\nvar Y = flow.get(\"Y\")||0;\nvar newmsg;\nif(msg.payload.key=='DOWN'&msg.payload.state==1){\n\n\n\n\n\n    if(X<7)\n    {\n        newmsg = {\n        \"payload\" : X+','+Y+',off,'+(X+1)+','+Y+',blue'\n        }\n        X+=1;\n        flow.set(\"X\", X);\n    }\n}\n\nif(msg.payload.key=='UP'&msg.payload.state==1){\n    if(X>0)\n    {\n        newmsg = {\n        \"payload\" : X+','+Y+',off,'+(X-1)+','+Y+',green'\n        }\n        X-=1;\n        flow.set(\"X\", X);\n    }\n}\n\nif(msg.payload.key=='RIGHT'&msg.payload.state==1){\n    if(Y>0)\n    {\n        newmsg = {\n        \"payload\" : X+','+Y+',off,'+X+','+(Y-1)+',red'\n        }\n        Y-=1;\n        flow.set(\"Y\", Y);\n    }\n}\n\nif(msg.payload.key=='LEFT'&msg.payload.state==1){\n    if(Y<7)\n    {\n        newmsg = {\n        \"payload\" : X+','+Y+',off,'+X+','+(Y+1)+',yellow'\n        }\n        Y+=1;\n        flow.set(\"Y\", Y);\n    }\n}\n\nif(msg.payload.key=='ENTER'&msg.payload.state==1){\n    \n        newmsg = {\n        \"payload\" : '*,*,off'\n        }\n    flow.set(\"X\", 0);\n    flow.set(\"Y\", 0);\n    \n}\n\nreturn newmsg;","outputs":1,"noerr":0,"x":262.8928451538086,"y":593.5713758468628,"wires":[["ac8a069.15c5bf8"]]},{"id":"b942010c.01f16","type":"rpi-sensehat in","z":"2e299254.21ad6e","name":"","motion":false,"env":false,"stick":true,"x":95.35712759835383,"y":593.5713221686227,"wires":[["24d0ab84.ab4f74"]]},{"id":"43212e63.f8f66","type":"inject","z":"2e299254.21ad6e","name":"","topic":"","payload":"R90","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":"","x":125.92857360839844,"y":407.8571491241455,"wires":[["ac8a069.15c5bf8"]]},{"id":"9cb7fa75.2ddd18","type":"udp out","z":"2e299254.21ad6e","name":"UDP OUT","addr":"192.168.1.0","iface":"","port":"2345","ipv":"udp4","outport":"2345","base64":false,"multicast":"multi","x":866.5001373291016,"y":328.7500352859497,"wires":[]},{"id":"1bd60a4a.f4a596","type":"function","z":"2e299254.21ad6e","name":"temperature","func":"var datenow = Date.now();\nvar tempInput = msg.payload;\ndatenow = datenow.toString();\ntemperaturenow = tempInput.temperature.toString();\nvar newMsg = {\n    \"payload\" :{\n        \"date\": datenow,\n        \"temperature\": temperaturenow\n    },\n    \"topic\": \"INSERT INTO blockchainlist(currentdate, temperature) values ( \" + datenow + \", \" + temperaturenow + \")\"\n        };\nreturn newMsg;","outputs":1,"noerr":0,"x":347.0216827392578,"y":313.0130157470703,"wires":[["ac8a069.15c5bf8","78c408b1.d67138"]]},{"id":"6b3ee3b3.b22fcc","type":"udp in","z":"2e299254.21ad6e","name":"","iface":"","port":"2345","ipv":"udp4","multicast":"false","group":"","datatype":"utf8","x":741.4800453186035,"y":572.3872089385986,"wires":[[]]},{"id":"8f806be0.e2b8a8","type":"debug","z":"2e299254.21ad6e","name":"TEST","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":852.9106140136719,"y":435.51304054260254,"wires":[]},{"id":"78c408b1.d67138","type":"split","z":"2e299254.21ad6e","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":553.7430725097656,"y":317.0069694519043,"wires":[["1806b2e0.33336d"]]},{"id":"1806b2e0.33336d","type":"join","z":"2e299254.21ad6e","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":701.7465515136719,"y":388.9687614440918,"wires":[["8f806be0.e2b8a8","9cb7fa75.2ddd18"]]}]